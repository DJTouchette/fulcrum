version: 3
name: create_user_tenants_table
description: "Create user_tenants table"
up:
  - create_table:
      name: user_tenants
      columns:
        - name: id
          type: serial
        - name: user_id
          type: bigint 
          nullable: false
        - name: tenant_id
          type: bigint 
          nullable: false
      constraints:
        - type: foreign_key
          column: user_id
          references:
            table: users
            column: id
            on_delete: cascade
        - type: foreign_key
          column: tenant_id
          references:
            table: tenants
            column: id
            on_delete: cascade
        - type: unique
          columns: [user_id, tenant_id]
down:
  - drop_table:
      name: user_tenants
